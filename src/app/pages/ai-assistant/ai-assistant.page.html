<!-- Backdrop overlay untuk close sidebar saat klik luar -->
<div class="sidebar-backdrop" (click)="closeChat()"></div>

<!-- Sidebar Panel -->
<div class="ai-sidebar">
  <!-- Header Sidebar -->
  <div class="sidebar-header">
    <div class="sidebar-title">
      <ion-icon name="chatbubbles" class="header-icon"></ion-icon>
      <h2>AI Assistant</h2>
    </div>
    <ion-button fill="clear" class="close-btn" (click)="closeChat()">
      <ion-icon name="close-outline"></ion-icon>
    </ion-button>
  </div>

  <!-- Chat Messages Area -->
  <div class="chat-messages">
    <div
      *ngFor="let msg of messages"
      class="message-row"
      [ngClass]="msg.sender"
    >
      <div class="message-avatar">{{ msg.avatar }}</div>
      <div class="message-bubble" [innerHTML]="msg.text"></div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="message-row ai">
      <div class="message-avatar">ğŸ¤–</div>
      <div class="message-bubble">
        <div class="typing-indicator">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Input Footer -->
  <div class="chat-footer">
    <div class="chat-input-wrapper">
      <ion-input
        [(ngModel)]="chatInput"
        placeholder="Tanyakan tentang PLTMH..."
        (keyup.enter)="sendMessage()"
        class="chat-input"
      ></ion-input>
      <ion-button
        (click)="sendMessage()"
        fill="clear"
        class="send-btn"
        [disabled]="!chatInput.trim()"
      >
        <ion-icon name="send"></ion-icon>
      </ion-button>
    </div>
  </div>
</div>